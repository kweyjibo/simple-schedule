{"version":3,"sources":["schedule.js","main.js"],"names":["ROW_CLASS","CELL_CLASS","COLUMN_CLASS","SELECTED_CLASS","HOVERED_CLASS","WEEKDAY_ATTR","HOUR_ATTR","byClass","root","className","nodeType","result","df","childNodes","length","childNode","getElementsByClassName","concat","Schedule","element","__element","rows","cells","weekdays","forEach","row","push","getAttribute","modelSelected","modelHovered","weekday","boundOnMouseUp","onMouseUp","bind","window","addEventListener","event","type","target","classList","contains","onChooseRow","onChooseColumn","onMouseDown","onHover","onHoveredRow","onHoveredColumn","model","cell","hour","selected","hovered","toggle","select","toString","render","flag","start","end","selection","preventDefault","overRectangle","setDefaults","fn","firsWeekdayIndex","indexOf","lastWeekdayIndex","startWeekdayIndex","Math","min","endWeekdayIndex","max","startHour","parseInt","endHour","weekdayIndex","removeEventListener","_element","document","getElementById","schedule"],"mappings":"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","file":"main.4b9fca68.js","sourceRoot":"../src","sourcesContent":["/**\n * CONST\n */\nconst ROW_CLASS = 'js-schedule-day';\nconst CELL_CLASS = 'js-schedule-cell';\nconst COLUMN_CLASS = 'js-schedule-hour';\nconst SELECTED_CLASS = '__selected';\nconst HOVERED_CLASS = '__hovered';\nconst WEEKDAY_ATTR = 'data-weekday';\nconst HOUR_ATTR = 'data-hour';\n\n/**\n * @param {HTMLElement} root\n * @param {string} className\n * @returns {HTMLElement[]}\n */\nfunction byClass(root, className) {\n    if (root) {\n        if (root.nodeType === 11) { // == Node.DOCUMENT_FRAGMENT_NODE\n            let result = [];\n            for (let df = 0; df < root.childNodes.length; df++) {\n                let childNode = root.childNodes[df];\n                if (childNode.getElementsByClassName) {\n                    result = result.concat([...childNode.getElementsByClassName(className)]);\n                }\n            }\n            return result;\n        }\n        return [...root.getElementsByClassName(className)];\n    }\n    return [];\n}\n\nexport default class Schedule {\n\n    constructor (element) {\n\n        this.__element = element;\n        \n        this.rows = byClass(element, ROW_CLASS);\n        this.cells = byClass(element, CELL_CLASS);\n\n        let weekdays = this.weekdays = [];\n        this.rows.forEach(function (row) {\n            weekdays.push(row.getAttribute(WEEKDAY_ATTR));\n        });\n        \n        this.modelSelected = {};\n        this.modelHovered = {};\n\n        this.weekdays.forEach((weekday) => {\n            this.modelSelected[weekday] = [];\n            this.modelHovered[weekday] = [];\n        });\n\n        this.boundOnMouseUp = this.onMouseUp.bind(this);\n        window.addEventListener('mouseup', this.boundOnMouseUp);\n        this.__element.addEventListener('click', this);\n        this.__element.addEventListener('mousedown', this);\n        this.__element.addEventListener('mouseup', this);\n        this.__element.addEventListener('mouseover', this);\n        this.__element.addEventListener('mouseout', this);\n    };\n\n    /**\n     * @param {Event} event\n     */\n    handleEvent(event) {\n        switch(event.type) {\n            case 'click':\n                if (event.target.classList.contains(ROW_CLASS)) {\n                    this.onChooseRow(event);\n                }\n                if (event.target.classList.contains(COLUMN_CLASS)) {\n                    this.onChooseColumn(event);\n                }\n                break;\n            case 'mousedown':\n                if (event.target.classList.contains(CELL_CLASS)) {\n                    this.onMouseDown(event);\n                }\n                break;\n            case 'mouseup':\n                if (event.target.classList.contains(CELL_CLASS)) {\n                    this.onMouseUp(event);\n                }\n                break;\n            case 'mouseover':\n                if (event.target.classList.contains(CELL_CLASS)) {\n                    this.onHover(event);\n                }\n                if (event.target.classList.contains(ROW_CLASS)) {\n                    this.onHoveredRow(event, true);\n                }\n                if (event.target.classList.contains(COLUMN_CLASS)) {\n                    this.onHoveredColumn(event, true);\n                }\n                break;\n            case 'mouseout':\n                if (event.target.classList.contains(ROW_CLASS)) {\n                    this.onHoveredRow(event, false);\n                }\n                if (event.target.classList.contains(COLUMN_CLASS)) {\n                    this.onHoveredColumn(event, false);\n                }\n                break;\n        }\n    }\n\n    /**\n     * @param {Object} model\n     */\n    setDefaults(model) {\n        this.weekdays.forEach(function (weekday) {\n            if (!model[weekday]) {\n                model[weekday] = {};\n            }\n        });\n    };\n\n    /**\n     *\n     */\n    render() {\n        let modelSelected = this.modelSelected;\n        let modelHovered = this.modelHovered;\n        let count = 0;\n\n        this.cells.forEach(function (cell) {\n            let weekday = cell.getAttribute(WEEKDAY_ATTR);\n            let hour = cell.getAttribute(HOUR_ATTR);\n            let selected = modelSelected[weekday][hour];\n            let hovered = modelHovered[weekday][hour];\n\n            if (selected) {\n                count += 1;\n            }\n\n            cell.classList.toggle(SELECTED_CLASS, selected === true);\n            cell.classList.toggle(HOVERED_CLASS, hovered === true);\n        });\n    };\n\n    /**\n     * @param {Event} event\n     */\n    onChooseRow(event) {\n        let weekday = event.target.getAttribute(WEEKDAY_ATTR);\n        let model = this.modelSelected;\n        let hour, select = false;\n\n        for (hour = 0; hour < 24; hour++) {\n            if (!model[weekday][hour.toString()]) {\n                select = true;\n            }\n        }\n\n        for (hour = 0; hour < 24; hour++) {\n            model[weekday][hour.toString()] = select;\n        }\n\n        this.render();\n    };\n\n    /**\n     * @param {Event} event\n     */\n    onChooseColumn(event) {\n        let hour = event.target.getAttribute(HOUR_ATTR);\n        let model = this.modelSelected;\n        let select = false;\n\n        this.weekdays.forEach(function (weekday) {\n            if (!model[weekday][hour]) {\n                select = true;\n            }\n        });\n\n        this.weekdays.forEach(function (weekday) {\n            model[weekday][hour] = select;\n        });\n\n        this.render();\n    };\n\n    /**\n     * @param {Boolean} flag\n     * @param {Event} event\n     */\n    onHoveredRow(event, flag) {\n        if (this.start || this.end) {\n            return;\n        }\n\n        let weekday = event.target.getAttribute(WEEKDAY_ATTR);\n\n        for (let hour = 0; hour < 24; hour++) {\n            this.modelHovered[weekday][hour] = flag;\n        }\n\n        this.render();\n    };\n\n    /**\n     * @param {Event} event\n     * @param {Boolean} flag\n     */\n    onHoveredColumn(event, flag) {\n        if (this.selection) {\n            return;\n        }\n\n        let hour = event.target.getAttribute(HOUR_ATTR);\n        let modelHovered = this.modelHovered;\n\n        this.weekdays.forEach(function (weekday) {\n            modelHovered[weekday][hour] = flag;\n        });\n\n        this.render();\n    };\n\n    /**\n     * @param {Event} event\n     */\n    onMouseDown(event) {\n        event.preventDefault();\n\n        let weekday = event.target.getAttribute(WEEKDAY_ATTR);\n        let hour = event.target.getAttribute(HOUR_ATTR);\n\n        this.selection = {\n            start: {\n                weekday: weekday,\n                hour: hour\n            },\n\n            end: {\n                weekday: weekday,\n                hour: hour\n            }\n        };\n    };\n\n    /**\n     *\n     */\n    onMouseUp() {\n        if (!this.selection) {\n            return;\n        }\n\n        let modelSelected = this.modelSelected;\n        let select = false;\n\n        this.overRectangle(this.selection.start, this.selection.end, function (weekday, hour) {\n            if (!modelSelected[weekday][hour]) {\n                select = true;\n            }\n        });\n\n        this.overRectangle(this.selection.start, this.selection.end, function (weekday, hour) {\n            modelSelected[weekday][hour] = select;\n        });\n\n        this.modelHovered = {};\n        this.setDefaults(this.modelHovered);\n\n        this.selection = null;\n\n        this.render();\n    };\n\n    /**\n     * @param {Event} event\n     */\n    onHover(event) {\n        let weekday = event.target.getAttribute(WEEKDAY_ATTR);\n        let hour = event.target.getAttribute(HOUR_ATTR);\n\n        if (!this.selection) {\n            return;\n        }\n\n        this.selection.end = {\n            weekday: weekday,\n            hour: hour\n        };\n\n        let modelHovered = this.modelHovered = {};\n        this.setDefaults(this.modelHovered);\n\n        this.overRectangle(this.selection.start, this.selection.end, function (weekday, hour) {\n            modelHovered[weekday][hour] = true;\n        });\n\n        this.render();\n    };\n\n    /**\n     * @param {Object} start\n     * @param {Object} end\n     * @param {Function} fn\n     */\n    overRectangle(start, end, fn) {\n        let firsWeekdayIndex =  this.weekdays.indexOf(start.weekday);\n        let lastWeekdayIndex = this.weekdays.indexOf(end.weekday);\n        let startWeekdayIndex = Math.min(firsWeekdayIndex,lastWeekdayIndex);\n        let endWeekdayIndex = Math.max(firsWeekdayIndex,lastWeekdayIndex);\n\n        let startHour = Math.min(end.hour, parseInt(start.hour));\n        let endHour = Math.max(end.hour, parseInt(start.hour));\n\n        for (let weekdayIndex = startWeekdayIndex; weekdayIndex <= endWeekdayIndex; weekdayIndex++) {\n            let weekday = this.weekdays[weekdayIndex];\n            for (let hour = startHour; hour <= endHour; hour++) {\n                fn(weekday, hour);\n            }\n        }\n    };\n\n    destroy() {\n        window.removeEventListener('mouseup', this.boundOnMouseUp);\n        this._element.removeEventListener('click', this, false);\n        this._element.removeEventListener('mousedown', this, false);\n        this._element.removeEventListener('mouseup', this, false);\n        this._element.removeEventListener('mouseover', this, false);\n        this._element.removeEventListener('mouseout', this, false);\n    }\n}","import Schedule from './schedule.js';\n\nlet element = document.getElementById('schedule');\nlet schedule = new Schedule(element);"]}